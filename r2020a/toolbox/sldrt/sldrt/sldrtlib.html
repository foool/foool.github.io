<html>
<head>

<style>
p {
    color : black; font-family:courier; font-size: 80%;
}
body {
    line-height: 120%; font-family:courier; font-zize:60%;
}
.tlc_func {color : blue; font-weight: bold; font-size:120%;}
.tlc_comment {color : #9aa;}
.tlc_if {color: green;}.tlc_assign {color: green;}.tlc_each {color: green;}.tlc_foreach {color: green;}.tlc_endif {color: green;}.tlc_switch {color: green;}.tlc_case {color: green;}.tlc_return {color: green;}.tlc_elseif {color: green;}.tlc_else {color: green;}.tlc_assert {color: green;}.tlc_endwith {color: green;}.tlc_endforeach {color: green;}.tlc_generatefile {color: green;}.tlc_includepath {color: green;}.tlc_include {color: green;}.tlc_sprintf {color: green;}.tlc_while {color: green;}.tlc_endwhile {color: green;}.tlc_default {color: green;}.tlc_createrecord {color: green;}.tlc_mergerecord {color: green;}.tlc_language {color: green;}.tlc_roll {color: green;}.tlc_endroll {color: green;}.tlc_with {color: green;}.tlc_selectfile {color: green;}.tlc_openfile {color: green;}.tlc_closefile {color: green;}.tlc_def {color: green;}.tlc_undef {color: green;}.tlc_realformat {color: green;}.tlc_endswitch {color: green;}.tlc_addtorecord {color: green;}.tlc_break {color: green;}
.tlc_bifunc {color: brown;}
.tlc_fkw {color:blue; font-weight: 800;}
.tlc_output {color:#FFF; font-style:italic;}
.tlc_mchar {color:purple;}
</style>

</head>
<body>
<span class="tlc_comment">%%****************************************************************************
</span> <br><span class="tlc_comment">%%****************************************************************************
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>TLC<span style="padding-left:9.5px"></span>Functions<span style="padding-left:9.5px"></span>common<span style="padding-left:9.5px"></span>for<span style="padding-left:9.5px"></span>all<span style="padding-left:9.5px"></span>Simulink<span style="padding-left:9.5px"></span>Desktop<span style="padding-left:9.5px"></span>Real-Time<span style="padding-left:9.5px"></span>blocks
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Copyright<span style="padding-left:9.5px"></span>1994-2016<span style="padding-left:9.5px"></span>The<span style="padding-left:9.5px"></span>MathWorks,<span style="padding-left:9.5px"></span>Inc.
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%****************************************************************************
</span> <br><span class="tlc_comment">%%****************************************************************************
</span> <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLDRTIsAccelerator<span style="padding-left:9.5px"></span>====================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Return<span style="padding-left:9.5px"></span>true<span style="padding-left:9.5px"></span>if<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>current<span style="padding-left:9.5px"></span>target<span style="padding-left:9.5px"></span>is<span style="padding-left:9.5px"></span>host-based<span style="padding-left:9.5px"></span>Accelerator
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLDRTIsAccelerator" class="tlc_func">SLDRTIsAccelerator</a>() <span class="tlc_fkw">void</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> Accelerator || <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibIsModelReferenceSimTarget">LibIsModelReferenceSimTarget</a>()
 <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTIsAccelerator</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLDRTCheckSysTLC<span style="padding-left:9.5px"></span>====================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Check<span style="padding-left:9.5px"></span>for<span style="padding-left:9.5px"></span>correct<span style="padding-left:9.5px"></span>system<span style="padding-left:9.5px"></span>TLC.
</span> <br><span class="tlc_comment">%%
</span> <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="SLDRTCheckSysTLC" class="tlc_func">SLDRTCheckSysTLC</a>(block) <span class="tlc_fkw">void</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% do not check STF if building for Accelerator</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/MATLAB/R2020a/toolbox/sldrt/sldrt/sldrtlib.html#SLDRTIsAccelerator">SLDRTIsAccelerator</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% report error for non-SLDRT targets</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !<span class="tlc_bifunc">EXISTS</span>(SLDRTBoards)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> stf = ::CompiledModel.ConfigSet.SystemTargetFile
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> blockpath = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibGetFormattedBlockPath">LibGetFormattedBlockPath</a>(block)
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> (stf == "raccel.tlc")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#SLibReportErrorWithIdAndArgs">SLibReportErrorWithIdAndArgs</a>("sldrt:tlc:raccelunsupported", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;["%<<span>blockpath</span>>"])>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#SLibReportErrorWithIdAndArgs">SLibReportErrorWithIdAndArgs</a>("sldrt:tlc:stfunsupported", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;["%<<span>blockpath</span>>", "%<<span>stf</span>>"])>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_exit">%exit</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTCheckSysTLC</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLDRTRegisterBoard<span style="padding-left:9.5px"></span>====================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Add<span style="padding-left:9.5px"></span>board<span style="padding-left:9.5px"></span>into<span style="padding-left:9.5px"></span>SLDRTBoards<span style="padding-left:9.5px"></span>if<span style="padding-left:9.5px"></span>needed;
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>get<span style="padding-left:9.5px"></span>board<span style="padding-left:9.5px"></span>index<span style="padding-left:9.5px"></span>in<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>SLDRTBoards<span style="padding-left:9.5px"></span>table.
</span> <br><span class="tlc_comment">%%
</span> <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="SLDRTRegisterBoard" class="tlc_func">SLDRTRegisterBoard</a>(block) <span class="tlc_fkw">void</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% report error for non-SLDRT targets</span>
 <br>&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/toolbox/sldrt/sldrt/sldrtlib.html#SLDRTCheckSysTLC">SLDRTCheckSysTLC</a>(block)>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% report error if trying to register a board from a model reference target</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibIsModelReferenceTarget">LibIsModelReferenceTarget</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#SLibReportErrorWithIdAndArgs">SLibReportErrorWithIdAndArgs</a>("sldrt:tlc:mdlrefhwunsupported", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;["%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibGetFormattedBlockPath">LibGetFormattedBlockPath</a>(block)>"])>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% search for the board in the SLDRTBoards table</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> BoardIdx = -1
 <br>&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = ::SLDRTBoards.BoardCount
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_with">%with</span> ::SLDRTBoards.Board[%<<span>idx</span>>]
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> Name == "%<<span>DrvName</span>>" &amp;&amp; Address == %<<span>DrvAddress</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> BoardIdx = %<<span>idx</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_break">%break</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endwith">%endwith</span>
 <br>&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% if not found, add it to the table and emit the options array into code</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> BoardIdx == -1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> optlen = <span class="tlc_bifunc">SIZE</span>(DrvOptions, 1)
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> tempVar = Board { Name  DrvName;  Address  DrvAddress; OptionsSize  %<<span>optlen</span>>}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ::SLDRTBoards = ::SLDRTBoards + Board
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_undef">%undef</span> tempVar
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> BoardIdx = ::SLDRTBoards.BoardCount
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ::SLDRTBoards.BoardCount = ::SLDRTBoards.BoardCount + 1
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> optlen > 0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> sldrtoptbuffer
 <br>&nbsp; <br>&nbsp;&nbsp;/* options for Simulink Desktop Real-Time board %<<span>BoardIdx</span>> */
 <br>&nbsp;&nbsp;static double SLDRTBoardOptions%<<span>BoardIdx</span>>[] = {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = optlen
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<DrvOptions[idx]>,
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;};
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> sldrtoptbuffer
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibSetSourceFileSection">LibSetSourceFileSection</a>(<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibGetModelDotCFile">LibGetModelDotCFile</a>(), "Definitions", sldrtoptbuffer)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% store the BoardIdx into block scope</span>
 <br>&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibAddIdentifier">LibAddIdentifier</a>(block, "SLDRTBoardIdx", BoardIdx)>
 <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTRegisterBoard</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLDRTEmitBoards<span style="padding-left:9.5px"></span>====================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Format<span style="padding-left:9.5px"></span>and<span style="padding-left:9.5px"></span>emit<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>SLDRTBoards<span style="padding-left:9.5px"></span>table<span style="padding-left:9.5px"></span>into<span style="padding-left:9.5px"></span>C<span style="padding-left:9.5px"></span>code.
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Called<span style="padding-left:9.5px"></span>from<span style="padding-left:9.5px"></span>system<span style="padding-left:9.5px"></span>TLC<span style="padding-left:9.5px"></span>file.
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLDRTEmitBoards" class="tlc_func">SLDRTEmitBoards</a>() <span class="tlc_fkw">void</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% return immediately if no boards to emit or if model-reference target</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> ::SLDRTBoards.BoardCount<=0 || <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibIsModelReferenceTarget">LibIsModelReferenceTarget</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% open buffer for board list</span>
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> sldrtboardbuffer
 <br>&nbsp; <br>/* list of Simulink Desktop Real-Time boards */
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% list the boards into the buffer</span>
 <br>&nbsp;&nbsp;%<<span>ExternCPrefix</span>> const int SLDRTBoardCount = %<::SLDRTBoards.BoardCount>;
 <br>&nbsp;&nbsp;%<<span>ExternCPrefix</span>> SLDRTBOARD SLDRTBoards[%<::SLDRTBoards.BoardCount>] = {
 <br>&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = ::SLDRTBoards.BoardCount
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_with">%with</span> ::SLDRTBoards.Board[%<<span>idx</span>>]
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> OptionsSize == 0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "%<<span>Name</span>>", %<<span>Address</span>>, 0, NULL },
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "%<<span>Name</span>>", %<<span>Address</span>>, %<<span>OptionsSize</span>>, SLDRTBoardOptions%<<span>idx</span>> },
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endwith">%endwith</span>
 <br>&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;};
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> sldrtboardbuffer
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_with">%with</span> CompiledModel
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibSetSourceFileSection">LibSetSourceFileSection</a>(<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibGetModelDotCFile">LibGetModelDotCFile</a>(), "Definitions", sldrtboardbuffer)>
 <br>&nbsp;&nbsp;<span class="tlc_endwith">%endwith</span>
 <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTEmitBoards</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>SLDRTEmitTimers<span style="padding-left:9.5px"></span>===================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Format<span style="padding-left:9.5px"></span>and<span style="padding-left:9.5px"></span>emit<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>SLDRTTimers<span style="padding-left:9.5px"></span>table<span style="padding-left:9.5px"></span>into<span style="padding-left:9.5px"></span>C<span style="padding-left:9.5px"></span>code.
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Called<span style="padding-left:9.5px"></span>from<span style="padding-left:9.5px"></span>system<span style="padding-left:9.5px"></span>TLC<span style="padding-left:9.5px"></span>file.
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLDRTEmitTimers" class="tlc_func">SLDRTEmitTimers</a>() <span class="tlc_fkw">void</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% return immediately if model-reference target</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibIsModelReferenceTarget">LibIsModelReferenceTarget</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% open buffer for sample time list</span>
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> sldrttimerbuffer
 <br>&nbsp; <br>/* list of Simulink Desktop Real-Time timers */
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% list timer sample times and offsets into the buffer</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> timernum = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibGetNumSyncPeriodicTasks">LibGetNumSyncPeriodicTasks</a>()
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> tid01eq = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibGetTID01EQ">LibGetTID01EQ</a>()
 <br>&nbsp;&nbsp;%<<span>ExternCPrefix</span>> const int SLDRTTimerCount = %<<span>timernum</span>>;
 <br>&nbsp;&nbsp;%<<span>ExternCPrefix</span>> const double SLDRTTimers[%<2*timernum>] = {
 <br>&nbsp;&nbsp;<span class="tlc_with">%with</span> ::CompiledModel
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = timernum
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> tid = idx+tid01eq
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibGetClockTickStepSize">LibGetClockTickStepSize</a>(tid)>, %<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibGetSampleTimePeriodAndOffset">LibGetSampleTimePeriodAndOffset</a>(tid, 1)>,
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;<span class="tlc_endwith">%endwith</span>
 <br>&nbsp;&nbsp;};
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> sldrttimerbuffer
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_with">%with</span> CompiledModel
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibSetSourceFileSection">LibSetSourceFileSection</a>(<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibGetModelDotCFile">LibGetModelDotCFile</a>(), "Definitions", sldrttimerbuffer)>
 <br>&nbsp;&nbsp;<span class="tlc_endwith">%endwith</span>
 <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTEmitTimers</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>SLDRTERTEmitTaskTimeFcn<span style="padding-left:9.5px"></span>===========================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Format<span style="padding-left:9.5px"></span>and<span style="padding-left:9.5px"></span>emit<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>TaskTimeFcn<span style="padding-left:9.5px"></span>needed<span style="padding-left:9.5px"></span>for<span style="padding-left:9.5px"></span>ERT<span style="padding-left:9.5px"></span>external<span style="padding-left:9.5px"></span>mode.
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Called<span style="padding-left:9.5px"></span>from<span style="padding-left:9.5px"></span>system<span style="padding-left:9.5px"></span>TLC<span style="padding-left:9.5px"></span>file.
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLDRTERTEmitTaskTimeFcn" class="tlc_func">SLDRTERTEmitTaskTimeFcn</a>() <span class="tlc_fkw">void</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% return immediately if model-reference target</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibIsModelReferenceTarget">LibIsModelReferenceTarget</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_with">%with</span> CompiledModel
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% generate function prototype</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> sldrttaskfcnheader
 <br>&nbsp;&nbsp;&nbsp;&nbsp;/* Simulink Desktop Real-Time specific functions */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> ::GenCPP
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ifdef __cplusplus
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extern "C" {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#endif
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;time_T %<<span><a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibGetModelName">LibGetModelName</a>()</span>>_sldrtGetTaskTime(int_T tid);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> ::GenCPP
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ifdef __cplusplus
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#endif
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> sldrttaskfcnheader
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% generate function body</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> sldrttaskfcnbody
 <br>&nbsp;&nbsp;&nbsp;&nbsp;/* Simulink Desktop Real-Time specific functions */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;time_T %<<span><a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibGetModelName">LibGetModelName</a>()</span>>_sldrtGetTaskTime(int_T tid)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;{
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch(tid) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> tid01eq = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibGetTID01EQ">LibGetTID01EQ</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibGetNumSyncPeriodicTasks">LibGetNumSyncPeriodicTasks</a>()  <span class="tlc_comment">%% first TID (0 or 0 and 1)</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> idx==0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> tidx = tid01eq+1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case %<<span>tidx</span>> :
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibGetTaskTime">LibGetTaskTime</a>(0)>);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case %<idx+tid01eq> :                    <span class="tlc_comment">%% next TIDs (1 and above or 2 and above)</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/utillib.html#LibGetTaskTime">LibGetTaskTime</a>(idx+tid01eq)>);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(0.);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> sldrttaskfcnbody
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibSetSourceFileSection">LibSetSourceFileSection</a>(<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibGetModelDotHFile">LibGetModelDotHFile</a>(), "Functions", sldrttaskfcnheader)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibSetSourceFileSection">LibSetSourceFileSection</a>(<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/mw/codetemplatelib.html#LibGetModelDotCFile">LibGetModelDotCFile</a>(), "Functions", sldrttaskfcnbody)>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_endwith">%endwith</span>
 <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTERTEmitTaskTimeFcn</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLDRTExpandInput<span style="padding-left:9.5px"></span>====================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Expand<span style="padding-left:9.5px"></span>a<span style="padding-left:9.5px"></span>possibly<span style="padding-left:9.5px"></span>scalar<span style="padding-left:9.5px"></span>input<span style="padding-left:9.5px"></span>to<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>block<span style="padding-left:9.5px"></span>width,<span style="padding-left:9.5px"></span>converting<span style="padding-left:9.5px"></span>input<span style="padding-left:9.5px"></span>datatype
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLDRTExpandInput" class="tlc_func">SLDRTExpandInput</a>(block, portidx, outwidth, varname) <span class="tlc_fkw">Output</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% for contiguous real_T signal that does not need expansion, return just the pointer to the signal</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> inwidth = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/public_api/blkio_api.html#LibBlockInputSignalWidth">LibBlockInputSignalWidth</a>(portidx)
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> (ParamSettings.InputContiguous[portidx] == "yes") &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/public_api/blkio_api.html#LibBlockInputSignalDataTypeId">LibBlockInputSignalDataTypeId</a>(portidx) == 0) &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(inwidth == outwidth)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span> "((real_T*) (" + <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blkiolib.html#LibBlockInputSignalAddr">LibBlockInputSignalAddr</a>(portidx, "", "", 0) + "))"
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% declare variables to hold the expanded value</span>
 <br>&nbsp;&nbsp;double %<<span>varname</span>>[%<<span>outwidth</span>>];
 <br>&nbsp;&nbsp;double* %<<span>varname</span>>p = %<<span>varname</span>>;
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% expand the value, converting data type</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> (inwidth==1)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_roll">%roll</span> idx = [1:%<<span>outwidth</span>>], lcv = RollThreshold, block, "Roller", ""
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*%<<span>varname</span>>p++ = (double) %<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blkiolib.html#LibBlockInputSignal">LibBlockInputSignal</a>(portidx, "", lcv, 0)>;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endroll">%endroll</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% convert data type for non-double block input</span>
 <br>&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_roll">%roll</span> idx = RollRegions, lcv = RollThreshold, block, "Roller", "U"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*%<<span>varname</span>>p++ = (double) %<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blkiolib.html#LibBlockInputSignal">LibBlockInputSignal</a>(portidx, "", lcv, idx)>;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endroll">%endroll</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> varname
 <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTExpandInput</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLDRTExpandParameter<span style="padding-left:9.5px"></span>====================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Expand<span style="padding-left:9.5px"></span>a<span style="padding-left:9.5px"></span>possibly<span style="padding-left:9.5px"></span>scalar<span style="padding-left:9.5px"></span>parameter<span style="padding-left:9.5px"></span>to<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>block<span style="padding-left:9.5px"></span>output<span style="padding-left:9.5px"></span>width
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLDRTExpandParameter" class="tlc_func">SLDRTExpandParameter</a>(block, param, outwidth, varname) <span class="tlc_fkw">Output</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% for parameter that does not need expansion, return just the pointer to the parameter</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> inwidth = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/paramlib.html#LibBlockParameterWidth">LibBlockParameterWidth</a>(param)
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> (inwidth == outwidth)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span> <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/paramlib.html#LibBlockParameterAddr">LibBlockParameterAddr</a>(param, "", "", 0)
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% declare variables to hold the expanded value</span>
 <br>&nbsp;&nbsp;double %<<span>varname</span>>[%<<span>outwidth</span>>];
 <br>&nbsp;&nbsp;double* %<<span>varname</span>>p = %<<span>varname</span>>;
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% expand the scalar parameter value</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> inval = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/paramlib.html#LibBlockParameter">LibBlockParameter</a>(param, "", "", 0)
 <br>&nbsp;&nbsp;<span class="tlc_roll">%roll</span> idx = [1:%<<span>outwidth</span>>], lcv = RollThreshold, block, "Roller", ""
 <br>&nbsp;&nbsp;&nbsp;&nbsp;*%<<span>varname</span>>p++ = %<<span>inval</span>>;
 <br>&nbsp;&nbsp;<span class="tlc_endroll">%endroll</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> varname
 <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTExpandParameter</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLDRTAllocOutputBuffer<span style="padding-left:9.5px"></span>==================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Allocate<span style="padding-left:9.5px"></span>a<span style="padding-left:9.5px"></span>buffer<span style="padding-left:9.5px"></span>for<span style="padding-left:9.5px"></span>block<span style="padding-left:9.5px"></span>output<span style="padding-left:9.5px"></span>value<span style="padding-left:9.5px"></span>if<span style="padding-left:9.5px"></span>needed
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLDRTAllocOutputBuffer" class="tlc_func">SLDRTAllocOutputBuffer</a>(portidx, outwidth) <span class="tlc_fkw">Output</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% return the output port address directly if output type is real_T</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blkiolib.html#LibBlockOutputSignalDataTypeId">LibBlockOutputSignalDataTypeId</a>(portidx)==0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span> <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blkiolib.html#LibBlockOutputSignalAddr">LibBlockOutputSignalAddr</a>(portidx, "", "", 0)
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% create the temporary variable and pointer to it</span>
 <br>&nbsp;&nbsp;double inval[%<<span>outwidth</span>>];
 <br>&nbsp;&nbsp;double* invalp = inval;
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> "inval"
 <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTAllocOutputBuffer</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLDRTCopyOutputBuffer<span style="padding-left:9.5px"></span>==================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Copy<span style="padding-left:9.5px"></span>output<span style="padding-left:9.5px"></span>buffer<span style="padding-left:9.5px"></span>to<span style="padding-left:9.5px"></span>block<span style="padding-left:9.5px"></span>output<span style="padding-left:9.5px"></span>port<span style="padding-left:9.5px"></span>if<span style="padding-left:9.5px"></span>needed
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLDRTCopyOutputBuffer" class="tlc_func">SLDRTCopyOutputBuffer</a>(block, portidx, outwidth) <span class="tlc_fkw">Output</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_comment">%% no action if output type is real_T</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blkiolib.html#LibBlockOutputSignalDataTypeId">LibBlockOutputSignalDataTypeId</a>(portidx)==0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% copy output values from temporary variable to block output, converting data type</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> dtype = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blkiolib.html#LibBlockOutputSignalDataTypeName">LibBlockOutputSignalDataTypeName</a>(portidx, tRealPart)
 <br>&nbsp;&nbsp;<span class="tlc_roll">%roll</span> idx = RollRegions, lcv = RollThreshold, block, "Roller", "Y"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blkiolib.html#LibBlockOutputSignal">LibBlockOutputSignal</a>(portidx, "", lcv, idx)> = (%<<span>dtype</span>>) *invalp++;
 <br>&nbsp;&nbsp;<span class="tlc_endroll">%endroll</span>
 <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTCopyOutputBuffer</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLDRTNumOutputPortsMissedTicks<span style="padding-left:9.5px"></span>=========================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Generate<span style="padding-left:9.5px"></span>code<span style="padding-left:9.5px"></span>to<span style="padding-left:9.5px"></span>zero<span style="padding-left:9.5px"></span>missed<span style="padding-left:9.5px"></span>ticks<span style="padding-left:9.5px"></span>port;
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>return<span style="padding-left:9.5px"></span>number<span style="padding-left:9.5px"></span>of<span style="padding-left:9.5px"></span>output<span style="padding-left:9.5px"></span>ports<span style="padding-left:9.5px"></span>without<span style="padding-left:9.5px"></span>missed<span style="padding-left:9.5px"></span>ticks<span style="padding-left:9.5px"></span>port
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLDRTNumOutputPortsMissedTicks" class="tlc_func">SLDRTNumOutputPortsMissedTicks</a>(block) <span class="tlc_fkw">Output</span>
 <br><span class="tlc_comment">%%
</span> <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> numports = <a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blocklib.html#LibBlockNumOutputPorts">LibBlockNumOutputPorts</a>(block)
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> ShowMissedTicks
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> numports = numports-1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/MATLAB/R2020a/rtw/c/tlc/lib/blkiolib.html#LibBlockOutputSignal">LibBlockOutputSignal</a>(numports, "", "", 0)> = 0;  /* Missed Ticks value is always zero */
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> numports
 <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% SLDRTNumOutputPortsMissedTicks</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>[EOF]<span style="padding-left:9.5px"></span><a href="https://foool.github.io/MATLAB/R2020a/toolbox/sldrt/sldrt/sldrtlib.html">sldrtlib.tlc</a>
</span> <br></body></html>