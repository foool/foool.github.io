<html>
<head>

<style>
p {
    color : black; font-family:courier; font-size: 80%;
}
body {
    line-height: 120%; font-family:courier; font-zize:60%;
}
.tlc_func {color : blue; font-weight: bold; font-size:120%;}
.tlc_comment {color : #9aa;}
.tlc_if {color: green;}.tlc_assign {color: green;}.tlc_each {color: green;}.tlc_foreach {color: green;}.tlc_endif {color: green;}.tlc_switch {color: green;}.tlc_case {color: green;}.tlc_return {color: green;}.tlc_elseif {color: green;}.tlc_else {color: green;}.tlc_assert {color: green;}.tlc_endwith {color: green;}.tlc_endforeach {color: green;}.tlc_generatefile {color: green;}.tlc_includepath {color: green;}.tlc_include {color: green;}.tlc_sprintf {color: green;}.tlc_while {color: green;}.tlc_endwhile {color: green;}.tlc_default {color: green;}.tlc_createrecord {color: green;}.tlc_mergerecord {color: green;}.tlc_language {color: green;}.tlc_roll {color: green;}.tlc_endroll {color: green;}.tlc_with {color: green;}.tlc_selectfile {color: green;}.tlc_openfile {color: green;}.tlc_closefile {color: green;}.tlc_def {color: green;}.tlc_undef {color: green;}.tlc_realformat {color: green;}.tlc_endswitch {color: green;}.tlc_addtorecord {color: green;}.tlc_break {color: green;}
.tlc_bifunc {color: brown;}
.tlc_fkw {color:blue; font-weight: 800;}
.tlc_output {color:#FFF; font-style:italic;}
.tlc_mchar {color:purple;}
</style>

</head>
<body>
<span class="tlc_comment">%%<span style="padding-left:9.5px"></span>============================================================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>File<span style="padding-left:9.5px"></span>:<span style="padding-left:9.5px"></span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html">ertmdlreftiming.tlc</a>
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>This<span style="padding-left:9.5px"></span>is<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>system<span style="padding-left:9.5px"></span>library<span style="padding-left:9.5px"></span>file<span style="padding-left:9.5px"></span>for<span style="padding-left:9.5px"></span>code<span style="padding-left:9.5px"></span>generation's<span style="padding-left:9.5px"></span>Embedded-C<span style="padding-left:9.5px"></span>code<span style="padding-left:9.5px"></span>format.
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Copyright<span style="padding-left:9.5px"></span>1994-2019<span style="padding-left:9.5px"></span>The<span style="padding-left:9.5px"></span>MathWorks,<span style="padding-left:9.5px"></span>Inc.
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>For<span style="padding-left:9.5px"></span>more<span style="padding-left:9.5px"></span>information,<span style="padding-left:9.5px"></span>see<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>FcnERTIsSampleHit,<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>LibIsSampleHit,<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>LibIsSpecialSampleHit
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>============================================================================
</span> <br><span class="tlc_selectfile">%selectfile</span> NULL_FILE
 <br>&nbsp; <br><span class="tlc_if">%if</span> <span class="tlc_bifunc">EXISTS</span>("_ERT_MODELREF_TIMING_") == 0
 <br><span class="tlc_assign">%assign</span> _ERT_MODELREF_TIMING_ = 1
 <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="SLibComputeNumTaskTicks" class="tlc_func">SLibComputeNumTaskTicks</a>(period, stepSize) <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nTaskTicks = period / stepSize + 0.5
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nTaskTicks = <span class="tlc_bifunc">CAST</span>("Number",<span class="tlc_bifunc">FEVAL</span>("floor", nTaskTicks))
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> nTaskTicks
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Local<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>used<span style="padding-left:9.5px"></span>in<span style="padding-left:9.5px"></span>this<span style="padding-left:9.5px"></span>file
</span> <br><span class="tlc_fkw">%function</span> <a id="FcnComputeTaskTickLimit" class="tlc_func">FcnComputeTaskTickLimit</a>(tidIdx) <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> stepSize = <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibGetFundamentalStepSize">SLibGetFundamentalStepSize</a>()
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> period = SampleTime[tidIdx].PeriodAndOffset[0]
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> tidIdx == 0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nTaskTicks = 1
 <br>&nbsp;&nbsp;<span class="tlc_elseif">%elseif</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibControllableRateTID">SLibControllableRateTID</a>(tidIdx)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ctrlRateNumTicks = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("CtrlRateNumTicksToNextHit")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ctrlRateIdx = SampleTime[tidIdx].CtrlRateInstanceIndex
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ctrlRateRatio = SampleTime[tidIdx].CtrlRateBaseRatioToFundmentalStepSize
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nTaskTicks = "(%<<span>ctrlRateNumTicks</span>>[%<<span>ctrlRateIdx</span>>]*%<<span>ctrlRateRatio</span>>-1)"
 <br>&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nTaskTicks = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibComputeNumTaskTicks">SLibComputeNumTaskTicks</a>(period, stepSize) 
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> nTaskTicks
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Local<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>used<span style="padding-left:9.5px"></span>in<span style="padding-left:9.5px"></span>this<span style="padding-left:9.5px"></span>file
</span> <br><span class="tlc_fkw">%function</span> <a id="FcnComputeTaskTickOffset" class="tlc_func">FcnComputeTaskTickOffset</a>(tidIdx) <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> stepSize = <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibGetFundamentalStepSize">SLibGetFundamentalStepSize</a>()
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> period = SampleTime[tidIdx].PeriodAndOffset[0]
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> offset = SampleTime[tidIdx].PeriodAndOffset[1]
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibControllableRateTID">SLibControllableRateTID</a>(tidIdx) ||  offset == 0.0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nOffsetTicks = 0
 <br>&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nOffsetTicks = (period - offset)/stepSize + 0.5
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nOffsetTicks = <span class="tlc_bifunc">CAST</span>("Number",<span class="tlc_bifunc">FEVAL</span>("floor", nOffsetTicks))
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> nOffsetTicks
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="FcnInitializeSampleTimeOffsets" class="tlc_func">FcnInitializeSampleTimeOffsets</a>() 
 <br>&nbsp;&nbsp;<span class="tlc_assert">%assert</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsModelReferenceTarget">IsModelReferenceTarget</a>()
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> retBuff
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> commentAdded = TLC_FALSE
 <br>&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> tidIdx = NumSynchronousSampleTimes
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibControllableRateTID">SLibControllableRateTID</a>(tidIdx)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ctrlRateNumTicks = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("CtrlRateNumTicksToNextHit")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ctrlRateIdx = SampleTime[tidIdx].CtrlRateInstanceIndex
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nTaskTicks = "%<<span>ctrlRateNumTicks</span>>[%<<span>ctrlRateIdx</span>>]"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>nTaskTicks</span>> = 1;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> SampleTime[tidIdx].NeedFloatTime == "yes"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assert">%assert</span>  <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibIsERTCodeFormat">SLibIsERTCodeFormat</a>()           
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibGetTaskTime">LibGetTaskTime</a>(tidIdx)> = 0;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> offset = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnComputeTaskTickOffset">FcnComputeTaskTickOffset</a>(tidIdx)    
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> offset != 0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> tidIdx == 0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibReportFatalError">LibReportFatalError</a>("Base rate cannot have an offset")>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> !commentAdded
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* initialize sample time offsets */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> addedComment = TLC_TRUE
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmisreqfcns.html#RTMTaskCountersIsReqFcn">RTMTaskCountersIsReqFcn</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> cTick   = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("TaskCounters")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> counter = "%<<span>cTick</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateCounterField">SLibERTMultiRateCounterField</a>(tidIdx)>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>counter</span>> = %<<span>offset</span>>; %<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibTaskComment">LibTaskComment</a>(tidIdx)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> SampleTime[tidIdx].NeedFloatTime == "yes"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assert">%assert</span>  <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibIsERTCodeFormat">SLibIsERTCodeFormat</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibGetTaskTime">LibGetTaskTime</a>(tidIdx)> = %<SampleTime[tidIdx].PeriodAndOffset[1]>;          
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% Set the values in the CtrlRateMdlRefTiming in the top model</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibIsDeploymentDiagram">LibIsDeploymentDiagram</a>() &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;!<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsModelReferenceTarget">IsModelReferenceTarget</a>() &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmisreqfcns.html#RTMCtrlRateMdlRefTimingIsReqFcn">RTMCtrlRateMdlRefTimingIsReqFcn</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ctrlRateTiming = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("CtrlRateMdlRefTiming")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span>ctrlRateTiming</span>>.firstCtrlRateTID = %<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibFirstControllableRateTID">SLibFirstControllableRateTID</a>()</span>>;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> numTicksToNextHit = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("CtrlRateNumTicksToNextHit")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span>ctrlRateTiming</span>>.numTicksToNextHitForCtrlRate = %<<span>numTicksToNextHit</span>>;    
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> retBuff
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> retBuff
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLibGenERTTaskCountersSubStruct<span style="padding-left:9.5px"></span>==================================<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Generate<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>substructure<span style="padding-left:9.5px"></span>in<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>real-time<span style="padding-left:9.5px"></span>model<span style="padding-left:9.5px"></span>rtM.Timing.Counters
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Local<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>used<span style="padding-left:9.5px"></span>in<span style="padding-left:9.5px"></span>this<span style="padding-left:9.5px"></span>file
</span> <br><span class="tlc_fkw">%function</span> <a id="SLibGenERTTaskCountersSubStruct" class="tlc_func">SLibGenERTTaskCountersSubStruct</a>() <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> dtIdx = SampleTime[0].TaskCounterDataTypeId
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> dtype = <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/dtypelib.html#LibGetDataTypeNameFromId">LibGetDataTypeNameFromId</a>(dtIdx)
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> tmpFcnBuf
 <br>&nbsp;&nbsp;struct {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span>dtype</span>> TID[%<<span>NumSynchronousSampleTimes</span>>];
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span>  ::CompiledModel.SuppressMultiTaskScheduler &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!::CompiledModel.GenerateSampleERTMain
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>dtype</span>> cLimit[%<<span>NumSynchronousSampleTimes</span>>];
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;} /
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> tmpFcnBuf
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> tmpFcnBuf
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="FcnResetCTicksComment" class="tlc_func">FcnResetCTicksComment</a>() <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> haveOffset = 0
 <br>&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = NumSynchronousSampleTimes
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> SampleTime[idx].PeriodAndOffset[1] != 0.0 &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibControllableRateTID">SLibControllableRateTID</a>(idx)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> haveOffset = 1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_break">%break</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> txt
 <br>&nbsp; <br>&nbsp;&nbsp;/* Compute which subrates run during the next base time step.  Subrates
 <br>&nbsp;&nbsp;* are an integer multiple of the base rate counter.  Therefore, the subtask
 <br>&nbsp;&nbsp;* counter is reset when it reaches its limit (zero means run).
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> haveOffset
 <br>&nbsp;&nbsp;&nbsp;&nbsp;*
 <br>&nbsp;&nbsp;&nbsp;&nbsp;* Sample time offsets are handled by priming the counter with the
 <br>&nbsp;&nbsp;&nbsp;&nbsp;* appropriate non-zero value in the model's initialization function.
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;*/
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> txt
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> txt
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Local<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>used<span style="padding-left:9.5px"></span>in<span style="padding-left:9.5px"></span>this<span style="padding-left:9.5px"></span>file
</span> <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler" class="tlc_func">UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler</a>(tid) 
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> needUpdateRTFlags = <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibIsERTCodeFormat">SLibIsERTCodeFormat</a>() &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;(SuppressMultiTaskScheduler || (<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UseTargetTaskScheduler">UseTargetTaskScheduler</a>() &amp;&amp; !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>()))
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !needUpdateRTFlags
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span> ""
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> retBuf
 <br>&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = NumSynchronousSampleTimes - tid - 1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> j = idx + tid + 1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsModelReferenceTarget">IsModelReferenceTarget</a>() &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibGetNeedRateInteraction">SLibGetNeedRateInteraction</a>(tid, j)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> cTick = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("TaskCounters")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> shMat = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("PerTaskSampleHits")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> limit = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnComputeTaskTickLimit">FcnComputeTaskTickLimit</a>"><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnComputeTaskTickLimit">FcnComputeTaskTickLimit</a></a>(j)/<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnComputeTaskTickLimit">FcnComputeTaskTickLimit</a>"><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnComputeTaskTickLimit">FcnComputeTaskTickLimit</a></a>(tid)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/sysarglib.html#SLibAddTIDtoAccessTIDList">SLibAddTIDtoAccessTIDList</a>(...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System[NumSystems-1].Interface.RTMArgDef,::BlockFcn,"",tid)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> period = ::CompiledModel.SampleTime[tid].PeriodAndOffset[0]
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> offset = ::CompiledModel.SampleTime[tid].PeriodAndOffset[1]
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> s_period = ::CompiledModel.SampleTime[j].PeriodAndOffset[0]
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> s_offset = ::CompiledModel.SampleTime[j].PeriodAndOffset[1]
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* Update the flag to indicate when data transfers from 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*  Sample time: [%<<span>period</span>>s, %<<span>offset</span>>s] to Sample time: [%<<span>s_period</span>>s, %<<span>s_offset</span>>s]  */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#SLibModelHierarchyContainsNoninlinedSfcn">SLibModelHierarchyContainsNoninlinedSfcn</a>() || GenerateGRTWrapper
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("PerTaskSampleHitsPtr")>[%<j + tid*NumSynchronousSampleTimes>] = ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(%<<span>shMat</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,tid)> == 0);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span> 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#HasModelReferenceBlocks">HasModelReferenceBlocks</a>() 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>shMat</span>>.b_%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,tid)> = ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(%<<span>shMat</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,tid)> == 0);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(%<<span>shMat</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,tid)>)++;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((%<<span>shMat</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,tid)>) > %<limit-1>) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>shMat</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,tid)> = 0;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> retBuf
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> retBuf
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="UpdateRateTransitionFlagsHelper" class="tlc_func">UpdateRateTransitionFlagsHelper</a>(ss, tid, skipMajorTimeCheck) 
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> tmpBuf
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibIsERTCodeFormat">SLibIsERTCodeFormat</a>() &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;(SuppressMultiTaskScheduler || (<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UseTargetTaskScheduler">UseTargetTaskScheduler</a>() &amp;&amp; !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>())) &amp;&amp;...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;(<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsModelReferenceBaseSys">IsModelReferenceBaseSys</a>(ss) || ss.SystemIdx == NumSystems-1)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> FixedStepOpts.TID01EQ 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <span class="tlc_bifunc">ISEQUAL</span>(tid, 0) 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler">UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler</a>(0)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler">UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler</a>(1)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_elseif">%elseif</span> <span class="tlc_bifunc">ISEQUAL</span>(tid, 1) 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% do nothing</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler">UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler</a>(tid)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler">UpdateRateTransitionFlagsWhenSuppressMultiTaskScheduler</a>(tid)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> tmpBuf
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> retBuf
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !<span class="tlc_bifunc">WHITE_SPACE</span>(tmpBuf)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> !skipMajorTimeCheck &amp;&amp; (tid == 0) &amp;&amp; (NumContStates > 0)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMIs">RTMIs</a>("MajorTimeStep")>) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>tmpBuf</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}    
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>tmpBuf</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> retBuf
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> retBuf
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="FcnScheduleRateTransitions" class="tlc_func">FcnScheduleRateTransitions</a>() <span class="tlc_fkw">Output</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> ::CompiledModel.RequireMultiRateSampleHits
 <br>&nbsp;&nbsp;&nbsp;&nbsp;/* To ensure a deterministic data transfer between two rates,
 <br>&nbsp;&nbsp;&nbsp;&nbsp;* data is transferred at the priority of a fast task and the frequency
 <br>&nbsp;&nbsp;&nbsp;&nbsp;* of the slow task.  The following flags indicate when the data transfer
 <br>&nbsp;&nbsp;&nbsp;&nbsp;* happens.  That is, a rate interaction flag is set true when both rates
 <br>&nbsp;&nbsp;&nbsp;&nbsp;* will run, and false otherwise.
 <br>&nbsp;&nbsp;&nbsp;&nbsp;*/
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> cTick = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("TaskCounters")
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> shMat = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("PerTaskSampleHits")
 <br>&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> i = NumSynchronousSampleTimes
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> tmpFcnBuf
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> str = ""
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> comma = ""
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> plural = -1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> j = NumSynchronousSampleTimes
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibGetNeedRateInteraction">SLibGetNeedRateInteraction</a>(i,j)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>shMat</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,i)> = ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(%<<span>cTick</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateCounterField">SLibERTMultiRateCounterField</a>(j)> == 0);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> str = str + "%<<span>comma</span>>%<<span>j</span>>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> comma = ", "
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> plural = plural + 1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#SLibModelHierarchyContainsNoninlinedSfcn">SLibModelHierarchyContainsNoninlinedSfcn</a>() || GenerateGRTWrapper
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* update PerTaskSampleHits matrix for non-inline sfcn */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("PerTaskSampleHitsPtr")>[%<j + i*NumSynchronousSampleTimes>] = ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>shMat</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,i)>;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> tmpFcnBuf
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> !<span class="tlc_bifunc">WHITE_SPACE</span>(tmpFcnBuf)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* tid %<<span>i</span>> shares data with slower tid rate%<plural?"s":"">: %<<span>str</span>> */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> i == 0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span>tmpFcnBuf</span>>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;if (%<<span>cTick</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateCounterField">SLibERTMultiRateCounterField</a>(i)> == 0) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>tmpFcnBuf</span>>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Local<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>used<span style="padding-left:9.5px"></span>in<span style="padding-left:9.5px"></span>this<span style="padding-left:9.5px"></span>file
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>This<span style="padding-left:9.5px"></span>routine<span style="padding-left:9.5px"></span>returns<span style="padding-left:9.5px"></span>a<span style="padding-left:9.5px"></span>boolean<span style="padding-left:9.5px"></span>indicating<span style="padding-left:9.5px"></span>whether<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>sub-rate<span style="padding-left:9.5px"></span>code
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>is<span style="padding-left:9.5px"></span>empty<span style="padding-left:9.5px"></span>(minus<span style="padding-left:9.5px"></span>comments).<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>It<span style="padding-left:9.5px"></span>returns<span style="padding-left:9.5px"></span>'true'<span style="padding-left:9.5px"></span>if<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>sub-rate<span style="padding-left:9.5px"></span>code
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>is<span style="padding-left:9.5px"></span>not<span style="padding-left:9.5px"></span>empty<span style="padding-left:9.5px"></span>and<span style="padding-left:9.5px"></span>returns<span style="padding-left:9.5px"></span>'false'<span style="padding-left:9.5px"></span>if<span style="padding-left:9.5px"></span>it<span style="padding-left:9.5px"></span>is<span style="padding-left:9.5px"></span>empty.
</span> <br><span class="tlc_fkw">%function</span> <a id="FcnScheduleSubRates" class="tlc_func">FcnScheduleSubRates</a>() <span class="tlc_fkw">Output</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> cTick = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("TaskCounters")
 <br>&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnResetCTicksComment">FcnResetCTicksComment</a>()</span>>/
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> buff
 <br>&nbsp;&nbsp;<span class="tlc_comment">%% To be consistent with Simulink, Multitasking doesn't udpate</span>
 <br>&nbsp;&nbsp;<span class="tlc_comment">%% sampleHit array</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> needSampleHit = (<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#SLibModelHierarchyContainsNoninlinedSfcn">SLibModelHierarchyContainsNoninlinedSfcn</a>() || GenerateGRTWrapper) &amp;&amp; <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>()
 <br>&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = NumSynchronousSampleTimes - 1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> i = idx + 1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> counter = "%<<span>cTick</span>>.%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateCounterField">SLibERTMultiRateCounterField</a>(i)>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> limit = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnComputeTaskTickLimit">FcnComputeTaskTickLimit</a>(i)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <span class="tlc_bifunc">TYPE</span>(limit) == "Number" 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> limit = limit - 1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span>  <span class="tlc_bifunc">TYPE</span>(limit) != "Number" || limit > 0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(%<<span>counter</span>>)++;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((%<<span>counter</span>>) > %<<span>limit</span>>) { %<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibTaskComment">LibTaskComment</a>(i)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>counter</span>> = 0;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% Scheduler is called at the end of code current step.</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% SampleHit falgs will be used by subrate in next step.</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% Need update after counter increments for next step.</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> needSampleHit
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assert">%assert</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>() 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>("SampleHitPtr")>[%<<span>i</span>>]  = (%<<span>counter</span>> == 0);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> buff
 <br>&nbsp;&nbsp;%<<span>buff</span>>
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> !<span class="tlc_bifunc">WHITE_SPACE</span>(buff)
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLibERTMultiRateTimingField<span style="padding-left:9.5px"></span>=======================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Generate<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>field<span style="padding-left:9.5px"></span>name<span style="padding-left:9.5px"></span>for<span style="padding-left:9.5px"></span>rtM.Timing.RateInteraction.TID%<<span>i</span>>_%<<span>j</span>>
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLibERTMultiRateTimingField" class="tlc_func">SLibERTMultiRateTimingField</a>(slowTID,fastTID) <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <span class="tlc_bifunc">TYPE</span>(%<<span>slowTID</span>>) != "Number" || <span class="tlc_bifunc">TYPE</span>(%<<span>fastTID</span>>) != "Number"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> errTxt = "tid values must be integers: %<<span class="tlc_bifunc">TYPE</span>(slowTID)>, " ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"%<<span>slowTID</span>>, <span class="tlc_bifunc">TYPE</span>(fastTID)>, %<<span>fastTID</span>>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibReportFatalError">LibReportFatalError</a>(errTxt)>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> "TID%<<span>fastTID</span>>_%<<span>slowTID</span>>"
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp;&nbsp;&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLibERTMultiRateCounterField<span style="padding-left:9.5px"></span>======================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Generate<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>field<span style="padding-left:9.5px"></span>name<span style="padding-left:9.5px"></span>for<span style="padding-left:9.5px"></span>rtM.Timing.TaskCounters.TID[%<<span>tid</span>>]
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLibERTMultiRateCounterField" class="tlc_func">SLibERTMultiRateCounterField</a>(tid) <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> "TID[%<<span>tid</span>>]"
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp;&nbsp;&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Function:<span style="padding-left:9.5px"></span>SLibGenERTRateInteractionSubStruct<span style="padding-left:9.5px"></span>=================================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Generate<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>substructure<span style="padding-left:9.5px"></span>in<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>real-time<span style="padding-left:9.5px"></span>model<span style="padding-left:9.5px"></span>rtM.Timing.RateInteraction
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="SLibGenERTRateInteractionSubStruct" class="tlc_func">SLibGenERTRateInteractionSubStruct</a>() <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> dtIdx = SuppressMultiTaskScheduler || ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;(<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UseTargetTaskScheduler">UseTargetTaskScheduler</a>() &amp;&amp; !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>()) ? ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;SampleTime[0].TaskCounterDataTypeId : tSS_BOOLEAN  
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> dtype = <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/dtypelib.html#LibGetDataTypeNameFromId">LibGetDataTypeNameFromId</a>(dtIdx)
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> tmpFcnBuf
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> i = NumSynchronousSampleTimes
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> j = NumSynchronousSampleTimes
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibGetNeedRateInteraction">SLibGetNeedRateInteraction</a>(i,j)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>dtype</span>> %<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,i)>;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> (SuppressMultiTaskScheduler || ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UseTargetTaskScheduler">UseTargetTaskScheduler</a>() &amp;&amp; !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>())) &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#HasModelReferenceBlocks">HasModelReferenceBlocks</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/dtypelib.html#LibGetDataTypeNameFromId">LibGetDataTypeNameFromId</a>(tSS_BOOLEAN)> b_%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#SLibERTMultiRateTimingField">SLibERTMultiRateTimingField</a>(j,i)>;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> tmpFcnBuf
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !<span class="tlc_bifunc">WHITE_SPACE</span>(tmpFcnBuf)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> retVal
 <br>&nbsp;&nbsp;&nbsp;&nbsp;struct {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>tmpFcnBuf</span>>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;} /
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> retVal
 <br>&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> retVal = ""
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> retVal
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="FcnGenerateEventsForThisBaseRateFcn" class="tlc_func">FcnGenerateEventsForThisBaseRateFcn</a>() <span class="tlc_fkw">Output</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> prototype = ""
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> buff
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>() &amp;&amp; !SuppressSetEventsForThisBaseRateFcn &amp;&amp; !<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibIsExportFcnDiagram">SLibIsExportFcnDiagram</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assert">%assert</span>(!<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsModelReferenceTarget">IsModelReferenceTarget</a>())
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> GenerateGRTWrapper
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnName = "rt_SimUpdateDiscreteEvents"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> UsingMalloc
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> tmpfcnName = "_%<<span>fcnName</span>>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnParams = ["void  *pModel,", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"int_T  rtmNumSampTimes, ", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"void  *rtmTimingData, ", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"int_T  *rtmSampleHitPtr, ", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"int_T  *rtmPerTaskSampleHits"]
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> tmpfcnName = fcnName
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnParams = ["int_T  rtmNumSampTimes,", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"void  *rtmTimingData,",...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"int_T  *rtmSampleHitPtr,",...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"int_T  *rtmPerTaskSampleHits"]
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>                         
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnReturns = "time_T"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> prototype
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>fcnReturns</span>> %<<span>tmpfcnName</span>>(
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = <span class="tlc_bifunc">SIZE</span>(fcnParams, 1)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<fcnParams[idx]>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> prototype 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnReturns = "%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertlib.html#SLibGetGRTWrapperLinkage">SLibGetGRTWrapperLinkage</a>()</span>> %<<span>fcnReturns</span>>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_createrecord">%createrecord</span> fcnRec {Name tmpfcnName; Returns fcnReturns; Params fcnParams; Abstract ""; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category "model"; GeneratedBy "<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html">ertmdlreftiming.tlc</a>"; Type "Update"}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonhdrlib.html#SLibDumpFunctionBanner">SLibDumpFunctionBanner</a>(fcnRec)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_undef">%undef</span> fcnRec
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(tmpfcnName, "MemSecFuncExecute", "Pre")>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertlib.html#SLibGetGRTWrapperLinkage">SLibGetGRTWrapperLinkage</a>()</span>> %<<span>prototype</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> UsingMalloc
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<::tSimStructType>* %<::tSimStruct> = (%<<span>tSimStructType</span>>*) pModel;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = NumSynchronousSampleTimes -1
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtmSampleHitPtr[%<idx+1>] = %<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMTaskRunsThisBaseStep">RTMTaskRunsThisBaseStep</a>(idx+1)>;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> SuppressMultiTaskScheduler
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMUpdateTaskCounter">RTMUpdateTaskCounter</a>(idx+1)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/syslib.html#SLibUnusedParameter">SLibUnusedParameter</a>("rtmNumSampTimes")>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/syslib.html#SLibUnusedParameter">SLibUnusedParameter</a>("rtmTimingData")>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/syslib.html#SLibUnusedParameter">SLibUnusedParameter</a>("rtmPerTaskSampleHits")>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;return(-1);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(fcnName, "MemSecFuncExecute", "Post")>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_elseif">%elseif</span> !InlineSetEventsForThisBaseRateFcn
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnName = "%<<span>Name</span>>_SetEventsForThisBaseStep"    
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> fcnAbstract
 <br>Set which subrates need to run this base step (base rate always runs).
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> (TargetOS == "BareBoardExample") || (TargetOS == "NativeThreadsExample")
 <br>This function must be called prior to calling the model step function
 <br>in order to "remember" which rates need to run this base step.  The
 <br>buffering of events allows for overlapping preemption.
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> fcnAbstract
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnReturns = "void"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> MultiInstanceERTCode 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnParams = "boolean_T *eventFlags, %<::tSimStructType> *const %<::tSimStruct>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnParams = "boolean_T *eventFlags"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_createrecord">%createrecord</span> fcnRec {Name fcnName; Returns fcnReturns; Params fcnParams; Abstract fcnAbstract; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category "model"; GeneratedBy "<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html">ertmdlreftiming.tlc</a>"; Type "SetEvent"}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonhdrlib.html#SLibDumpFunctionBanner">SLibDumpFunctionBanner</a>(fcnRec)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_undef">%undef</span> fcnRec
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(fcnName, "MemSecFuncExecute", "Pre")>/      
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> prototype = "%<<span>fcnReturns</span>> %<<span>fcnName</span>>(%<<span>fcnParams</span>>)"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>prototype</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* Task runs when its counter is zero, computed via rtmStepTask macro */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> firstSubrateTID = 1 + FixedStepOpts.TID01EQ
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> idx = NumSynchronousSampleTimes - firstSubrateTID
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> flags_idx = idx + firstSubrateTID
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eventFlags[%<<span>flags_idx</span>>] = ((boolean_T)%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMTaskRunsThisBaseStep">RTMTaskRunsThisBaseStep</a>(flags_idx)>);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> SuppressMultiTaskScheduler
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMUpdateTaskCounter">RTMUpdateTaskCounter</a>(flags_idx)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(fcnName, "MemSecFuncExecute", "Post")>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> buff
 <br>&nbsp;&nbsp;<span class="tlc_comment">%% dump prototype in header file </span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !<span class="tlc_bifunc">WHITE_SPACE</span>(prototype)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> prototypeBuf
 <br>&nbsp;&nbsp;&nbsp;&nbsp;/* External function called from main */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> ::GenCPP
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ifdef __cplusplus
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extern "C" {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#endif
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> UsingMalloc &amp;&amp; GenerateGRTWrapper
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* Backward compatibility macro */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ifdef rt_SimUpdateDiscreteEvents
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#undef rt_SimUpdateDiscreteEvents
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#endif
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ifdef _RTW_COMBINE_MULTIPLE_MODELS
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#define rt_SimUpdateDiscreteEvents(x1,x2,x3,x4) rtmiDiscreteEvents(rtmcGetRTWRTModelMethodsInfo(rtmC),(x1),(x2),(x3),(x4))
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#else
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#define rt_SimUpdateDiscreteEvents(x1,x2,x3,x4) rtmiDiscreteEvents(rtmGetRTWRTModelMethodsInfo(S),(x1),(x2),(x3),(x4))
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#endif
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibExternInFcnDecls">LibExternInFcnDecls</a>()</span>>%<<span>prototype</span>>;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> ::GenCPP
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ifdef __cplusplus
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#endif
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> prototypeBuf
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/filepackaginglib.html#SLibCacheCodeToFile">SLibCacheCodeToFile</a>("mdl_extern_fcn_decl", prototypeBuf)>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> buff
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGetMulirateSchedulerName">FcnGetMulirateSchedulerName</a>()<span style="padding-left:9.5px"></span>=============================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>In<span style="padding-left:9.5px"></span>single<span style="padding-left:9.5px"></span>tasking,<span style="padding-left:9.5px"></span>use<span style="padding-left:9.5px"></span>rate_scheduler.<span style="padding-left:9.5px"></span>In<span style="padding-left:9.5px"></span>multi-tasking,<span style="padding-left:9.5px"></span>use<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>rate_monotonic_scheduler
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="FcnGetMulirateSchedulerName" class="tlc_func">FcnGetMulirateSchedulerName</a>() 
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>() || <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibConcurrentTasks">SLibConcurrentTasks</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span> "rate_scheduler" 
 <br>&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span> "rate_monotonic_scheduler"
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="FcnGenSchedulerFcnAbstract" class="tlc_func">FcnGenSchedulerFcnAbstract</a>()
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> abstractBuf
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>()
 <br>&nbsp;&nbsp;This function updates active task flag for each subrate.
 <br>The function is called at model base rate, hence the
 <br>generated code self-manages all its subrates.
 <br>&nbsp;&nbsp;<span class="tlc_elseif">%elseif</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibConcurrentTasks">SLibConcurrentTasks</a>()
 <br>&nbsp;&nbsp;This function updates active task flag for each subrate.
 <br>The function is called in the model base rate function. 
 <br>It maintains SampleHit information to allow scheduling 
 <br>of the subrates from the base rate function. 
 <br>&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;This function updates active task flag for each subrate 
 <br>and rate transition flags for tasks that exchange data. 
 <br>The function assumes rate-monotonic multitasking scheduler. 
 <br>The function must be called at model base rate so that 
 <br>the generated code self-manages all its subrates and rate 
 <br>transition flags. 
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> abstractBuf
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> abstractBuf
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGenerateMultirateScheduler">FcnGenerateMultirateScheduler</a>()<span style="padding-left:9.5px"></span>=============================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Multi-rate<span style="padding-left:9.5px"></span>models<span style="padding-left:9.5px"></span>need<span style="padding-left:9.5px"></span>update<span style="padding-left:9.5px"></span>active<span style="padding-left:9.5px"></span>task<span style="padding-left:9.5px"></span>flag<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="FcnGenerateMultirateScheduler" class="tlc_func">FcnGenerateMultirateScheduler</a>() <span class="tlc_fkw">Output</span>
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> buff = ""
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> prototypeBuf = ""
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnName = ""
 <br>&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !RootSystemIsSingleRate || <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibModelHasControllableRate">SLibModelHasControllableRate</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> buff
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> nr = NumRuntimeExportedRates
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnName = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGetMulirateSchedulerName">FcnGetMulirateSchedulerName</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> curBlockFcn = ::BlockFcn
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ::BlockFcn = "Rate_Scheduler"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> typePrefix = <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/syslib.html#SLibGetModelTypesNamespacePrefix">SLibGetModelTypesNamespacePrefix</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>() 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> schedulerCode
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ::NeedScheduler = %<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnScheduleSubRates">FcnScheduleSubRates</a>()</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> schedulerCode
 <br>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> ::NeedScheduler
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnAbstract = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGenSchedulerFcnAbstract">FcnGenSchedulerFcnAbstract</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsMultiInstanceERTOrModelReference">IsMultiInstanceERTOrModelReference</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnArgs = "%<<span>typePrefix</span>>%<::tSimStructType> *const %<::tSimStruct>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% rate_scheduler to be called in update fcn, </span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% need accessed rtm in UpdateFcn at tid0</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/sysarglib.html#SLibAddTIDtoAccessTIDList">SLibAddTIDtoAccessTIDList</a>(...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System[NumSystems-1].Interface.RTMArgDef,"Update", "",0)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnArgs = "void"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>  
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/autosarsup.html#SLibAutosarCompilerAbstractionRequired">SLibAutosarCompilerAbstractionRequired</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnReturns = "static " + <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/autosarsup.html#SLibAutosarCompilerAbstractionForFcnDeclRtnType">SLibAutosarCompilerAbstractionForFcnDeclRtnType</a>("void", "FuncInternal", "")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnReturns = "static void"        
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_createrecord">%createrecord</span> fcnRec {Name fcnName; Returns fcnReturns; Params fcnArgs; Abstract fcnAbstract; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category "model"; GeneratedBy "<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html">ertmdlreftiming.tlc</a>"; Type "Schedule"}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonhdrlib.html#SLibDumpFunctionBanner">SLibDumpFunctionBanner</a>(fcnRec)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_undef">%undef</span> fcnRec
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(fcnName, "MemSecFuncExecute", "Pre")>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/autosarsup.html#SLibAutosarCompilerAbstractionRequired">SLibAutosarCompilerAbstractionRequired</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> prototypeBuf = "static " + <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/autosarsup.html#SLibAutosarCompilerAbstractionForFcnDeclRtnType">SLibAutosarCompilerAbstractionForFcnDeclRtnType</a>("void", "FuncInternal", "") + " %<<span>fcnName</span>>(%<<span>fcnArgs</span>>);"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> prototypeBuf = "static void %<<span>fcnName</span>>(%<<span>fcnArgs</span>>);"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>fcnReturns</span>> %<<span>fcnName</span>>(%<<span>fcnArgs</span>>)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>schedulerCode</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(fcnName, "MemSecFuncExecute", "Post")>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnAbstract = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGenSchedulerFcnAbstract">FcnGenSchedulerFcnAbstract</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsMultiInstanceERTOrModelReference">IsMultiInstanceERTOrModelReference</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnArgs = "%<<span>typePrefix</span>>%<::tSimStructType> *const %<::tSimStruct>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% scheduler to be called output fcn,</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% need access rtm in OutputFcn at tid0</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/sysarglib.html#SLibAddTIDtoAccessTIDList">SLibAddTIDtoAccessTIDList</a>(...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System[NumSystems-1].Interface.RTMArgDef,"Output", "",0)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnArgs = "void"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>       
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibConcurrentTasks">SLibConcurrentTasks</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnReturns = "static void"      
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnReturns = "void"      
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_createrecord">%createrecord</span> fcnRec {Name fcnName; Returns fcnReturns; Params fcnArgs; Abstract fcnAbstract; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category "model"; GeneratedBy "<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html">ertmdlreftiming.tlc</a>"; Type "Schedule"}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonhdrlib.html#SLibDumpFunctionBanner">SLibDumpFunctionBanner</a>(fcnRec)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_undef">%undef</span> fcnRec
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(fcnName, "MemSecFuncExecute", "Pre")>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> prototypeBuf = "%<<span>fcnReturns</span>> %<<span>fcnName</span>>(%<<span>fcnArgs</span>>);"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>fcnReturns</span>> %<<span>fcnName</span>>(%<<span>fcnArgs</span>>)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> !SuppressMultiTaskScheduler
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnScheduleRateTransitions">FcnScheduleRateTransitions</a>()</span>>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% needScheduler required by API, but not used for multitasking case</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> needScheduler = %<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnScheduleSubRates">FcnScheduleSubRates</a>()</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(fcnName, "MemSecFuncExecute", "Post")>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> buff
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span> 
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibConcurrentTasks">SLibConcurrentTasks</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/filepackaginglib.html#SLibCacheCodeToFile">SLibCacheCodeToFile</a>("baseMdl_fcn_prototype", prototypeBuf)>
 <br>&nbsp;&nbsp;<span class="tlc_elseif">%elseif</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% Declare function in header file</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> externPrototypeBuf =  "%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibExternInFcnDecls">LibExternInFcnDecls</a>()</span>> %<<span>prototypeBuf</span>>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/syslib.html#SLibIsModelTypesModelClassNamespace">SLibIsModelTypesModelClassNamespace</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/syslib.html#SLibCacheCPPEncapModelData">SLibCacheCPPEncapModelData</a>("ExternData", externPrototypeBuf)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/filepackaginglib.html#SLibCacheCodeToFile">SLibCacheCodeToFile</a>("mdl_extern_fcn_decl", externPrototypeBuf)> 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ::BlockFcn = curBlockFcn
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> buff
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="UseTargetTaskScheduler" class="tlc_func">UseTargetTaskScheduler</a>() <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibGenerateNativeThreads">SLibGenerateNativeThreads</a>()
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>This<span style="padding-left:9.5px"></span>should<span style="padding-left:9.5px"></span>be<span style="padding-left:9.5px"></span>called<span style="padding-left:9.5px"></span>at<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>buttom<span style="padding-left:9.5px"></span>of<span style="padding-left:9.5px"></span>update<span style="padding-left:9.5px"></span>function
</span> <br><span class="tlc_fkw">%function</span> <a id="FcnCallSingleTaskingRateScheduler" class="tlc_func">FcnCallSingleTaskingRateScheduler</a>(tid)
 <br>&nbsp;&nbsp;<span class="tlc_assert">%assert</span> (<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>())
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> buff
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !RootSystemIsSingleRate &amp;&amp; ::NeedScheduler
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsMultiInstanceERTOrModelReference">IsMultiInstanceERTOrModelReference</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGetMulirateSchedulerName">FcnGetMulirateSchedulerName</a>()</span>>(%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib.html#GetSimStructExpr">GetSimStructExpr</a>(System[<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#GetBaseSystemIdx">GetBaseSystemIdx</a>()], ::tSimStruct)>);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGetMulirateSchedulerName">FcnGetMulirateSchedulerName</a>()</span>>();
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> buff
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> buff
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>This<span style="padding-left:9.5px"></span>should<span style="padding-left:9.5px"></span>be<span style="padding-left:9.5px"></span>called<span style="padding-left:9.5px"></span>at<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>top<span style="padding-left:9.5px"></span>of<span style="padding-left:9.5px"></span>output<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_fkw">%function</span> <a id="FcnCallMultiTaskingRateScheduler" class="tlc_func">FcnCallMultiTaskingRateScheduler</a>(tid)
 <br>&nbsp;&nbsp;<span class="tlc_assert">%assert</span> (!<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>())
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> buff
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !RootSystemIsSingleRate &amp;&amp; !SuppressMultiTaskScheduler &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;!<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UseTargetTaskScheduler">UseTargetTaskScheduler</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span>(<span class="tlc_bifunc">ISEQUAL</span>(tid, "") || <span class="tlc_bifunc">ISEQUAL</span>(tid, 0))
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonbodlib.html#FcnGenerateTidGuardOpenCode">FcnGenerateTidGuardOpenCode</a>(0)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% Rate scheduler is invoked at the end of the output function</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% Rate grouping off or base rate with rate grouping on</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsMultiInstanceERTOrModelReference">IsMultiInstanceERTOrModelReference</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGetMulirateSchedulerName">FcnGetMulirateSchedulerName</a>()</span>>(%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib.html#GetSimStructExpr">GetSimStructExpr</a>(System[<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#GetBaseSystemIdx">GetBaseSystemIdx</a>()], ::tSimStruct)>);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGetMulirateSchedulerName">FcnGetMulirateSchedulerName</a>()</span>>();
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonbodlib.html#FcnGenerateTidGuardCloseCode">FcnGenerateTidGuardCloseCode</a>(0)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>       
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> buff
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> buff
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="FcnDumpMultiRateScheduler" class="tlc_func">FcnDumpMultiRateScheduler</a>() <span class="tlc_fkw">void</span>
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !RootSystemIsSingleRate 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> multirateBuffer
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGenerateEventsForThisBaseRateFcn">FcnGenerateEventsForThisBaseRateFcn</a>()</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> (!SuppressMultiTaskScheduler || <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibConcurrentTasks">SLibConcurrentTasks</a>()) ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; !<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibIsDeploymentDiagram">LibIsDeploymentDiagram</a>() &amp;&amp; !<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibIsExportFcnDiagram">SLibIsExportFcnDiagram</a>() ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>() || !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UseTargetTaskScheduler">UseTargetTaskScheduler</a>())
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnGenerateMultirateScheduler">FcnGenerateMultirateScheduler</a>()</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> multirateBuffer 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/filepackaginglib.html#SLibCacheCodeToFile">SLibCacheCodeToFile</a>("baseMdl_fcn_defn", multirateBuffer)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br>&nbsp; <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="ErtOrModelrefGetTimingForTopOfOutputFcn" class="tlc_func">ErtOrModelrefGetTimingForTopOfOutputFcn</a>(ss, tid)
 <br>&nbsp;&nbsp;<span class="tlc_assert">%assert</span> (<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibIsERTCodeFormat">SLibIsERTCodeFormat</a>() &amp;&amp; ss.SystemIdx == NumSystems-1) &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;!<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsModelReferenceTarget">IsModelReferenceTarget</a>()
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> needMajorTimeGuard = ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tlc_bifunc">ISEQUAL</span>(tid,0) || <span class="tlc_bifunc">ISEQUAL</span>(tid, "")) &amp;&amp; NumContStates > 0
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> retBuf = ""
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> buf
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> (<span class="tlc_bifunc">ISEQUAL</span>(tid,0) || <span class="tlc_bifunc">ISEQUAL</span>(tid, "")) &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;((NumContStates > 0) || (UsingMalloc &amp;&amp; GenerateGRTWrapper))
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#ERTSetSolverStopTime">ERTSetSolverStopTime</a>()</span>>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_comment">%% This function either returns "", or returns the </span>
 <br>&nbsp;&nbsp;<span class="tlc_comment">%% code that update active task flags</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> (!<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>()) 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnCallMultiTaskingRateScheduler">FcnCallMultiTaskingRateScheduler</a>(tid)>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% skip the major time step check if the outloop already done it. </span>
 <br>&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#UpdateRateTransitionFlagsHelper">UpdateRateTransitionFlagsHelper</a>(ss, tid, needMajorTimeGuard)>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> buf
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> retBuf
 <br>&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> !<span class="tlc_bifunc">WHITE_SPACE</span>(buf)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> needMajorTimeGuard
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMIs">RTMIs</a>("MajorTimeStep")>) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<span>buf</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> needMajorTimeGuard
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} /* end MajorTimeStep */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> needMajorTimeGuard
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% update base rate absolute time from SolverInfo</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;/* Update absolute time of base rate at minor time step */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;if (%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMIs">RTMIs</a>("MinorTimeStep")>) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibGetTaskTime">LibGetTaskTime</a>(0)> = rtsiGetT(%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdldefs.html#RTMGetSolverInfo">RTMGetSolverInfo</a>()</span>>);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;} 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlrefabstime.html#FcnUpdateAsyncTimeAtMinorMajorTimeStep">FcnUpdateAsyncTimeAtMinorMajorTimeStep</a>()</span>>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> retBuf
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> retBuf
 <br>&nbsp; <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br>&nbsp; <br><span class="tlc_fkw">%function</span> <a id="ErtOrModelrefGetTimingForBottomOfUpdateFcn" class="tlc_func">ErtOrModelrefGetTimingForBottomOfUpdateFcn</a>(ss, tid, skipMajorTimeCheck)
 <br>&nbsp;&nbsp;&nbsp;<span class="tlc_assert">%assert</span> (<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibIsERTCodeFormat">SLibIsERTCodeFormat</a>() &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;(<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsModelReferenceBaseSys">IsModelReferenceBaseSys</a>(ss)  || ss.SystemIdx == NumSystems-1))
 <br>&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> buff               
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> continuousUpdate = ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tlc_bifunc">ISEQUAL</span>(tid,0) || <span class="tlc_bifunc">ISEQUAL</span>(tid, "")) &amp;&amp; (NumContStates > 0)
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> needMajorTimeGuard = !skipMajorTimeCheck &amp;&amp; continuousUpdate
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> needMajorTimeGuard
 <br>&nbsp;&nbsp;&nbsp;&nbsp;if (%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMIs">RTMIs</a>("MajorTimeStep")>) {
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <span class="tlc_bifunc">ISEQUAL</span>(tid, 0) || <span class="tlc_bifunc">ISEQUAL</span>(tid, "")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_comment">%% Stop sim buffer is empty for model reference</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assert">%assert</span> (!<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsModelReferenceTarget">IsModelReferenceTarget</a>() || ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_bifunc">WHITE_SPACE</span>(CachedCodeBuffsForRootSys.StopSimBuffer))
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span>CachedCodeBuffsForRootSys.StopSimBuffer</span>>/
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp; <br>&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#IsModelReferenceTarget">IsModelReferenceTarget</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> continuousUpdate
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> reuseArgs = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmodelarg.html#SLibModelFcnArgs">SLibModelFcnArgs</a>("ODEUpdateContinuousStates",2,0)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> !<span class="tlc_bifunc">ISEQUAL</span>(reuseArgs,"")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> reuseArgs = ", " + reuseArgs
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibIsPeriodicRateGrouping">SLibIsPeriodicRateGrouping</a>() &amp;&amp; !<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;if (%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/syslib.html#LibIsSampleHit">LibIsSampleHit</a>(1)>) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rt_ertODEUpdateContinuousStates(%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdldefs.html#RTMGetSolverInfo">RTMGetSolverInfo</a>()</span>>%<<span>reuseArgs</span>>);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_elseif">%elseif</span> !needMajorTimeGuard <span class="tlc_comment">%% No major time guard yet</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMIs">RTMIs</a>("MajorTimeStep")>) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rt_ertODEUpdateContinuousStates(%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdldefs.html#RTMGetSolverInfo">RTMGetSolverInfo</a>()</span>>%<<span>reuseArgs</span>>);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rt_ertODEUpdateContinuousStates(%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdldefs.html#RTMGetSolverInfo">RTMGetSolverInfo</a>()</span>>%<<span>reuseArgs</span>>);
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>  
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_assert">%assert</span> !<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#LibAsynchronousTriggeredTID">LibAsynchronousTriggeredTID</a>(tid)  
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> tmpBuf = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibIsMultiRateAndPeriodicRateGrouping">SLibIsMultiRateAndPeriodicRateGrouping</a>( System[NumSystems-1] ) ?  ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;CachedCodeBuffsForRootSys.UpdateAbsoluteTimeBuffer%<<span>tid</span>> : ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;CachedCodeBuffsForRootSys.UpdateAbsoluteTimeBuffer
 <br>&nbsp;&nbsp;%<<span>tmpBuf</span>>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_comment">%% This function either returns "", or returns the rate_scheduler</span>
 <br>&nbsp;&nbsp;<span class="tlc_comment">%% We do NOT need scheduler for export function models</span>
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#SLibSingleTasking">SLibSingleTasking</a>() &amp;&amp; !<a href="https://foool.github.io/r2020a/rtw/c/tlc/lib/utillib.html#SLibIsExportFcnDiagram">SLibIsExportFcnDiagram</a>()
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html#FcnCallSingleTaskingRateScheduler">FcnCallSingleTaskingRateScheduler</a>(tid)>
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> needMajorTimeGuard
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} /* end MajorTimeStep */
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> buff
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> buff
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>ERTSetSolverStopTime<span style="padding-left:9.5px"></span>======================
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="ERTSetSolverStopTime" class="tlc_func">ERTSetSolverStopTime</a>()
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> retBuf
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> needGuard = TLC_FALSE
 <br>&nbsp;&nbsp;<span class="tlc_comment">%%</span>
 <br>&nbsp;&nbsp;/* set solver stop time */
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ct  = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMDispatchToAccessFcn">RTMDispatchToAccessFcn</a>("ClockTick0", "get", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;"", "", <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib.html#GetSimStructExpr">GetSimStructExpr</a>(System[<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#GetBaseSystemIdx">GetBaseSystemIdx</a>()], ::tSimStruct))
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> ss = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMDispatchToAccessFcn">RTMDispatchToAccessFcn</a>("StepSize0", "get", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;"", "", <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib.html#GetSimStructExpr">GetSimStructExpr</a>(System[<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#GetBaseSystemIdx">GetBaseSystemIdx</a>()], ::tSimStruct))
 <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sutillib.html#SLibClockTickIsUnit32Pair">SLibClockTickIsUnit32Pair</a>(0)
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> cth  = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMDispatchToAccessFcn">RTMDispatchToAccessFcn</a>("ClockTickH0", "get", ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"", "", <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib.html#GetSimStructExpr">GetSimStructExpr</a>(System[<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/modelrefutil.html#GetBaseSystemIdx">GetBaseSystemIdx</a>()], ::tSimStruct))
 <br>&nbsp;&nbsp;&nbsp;&nbsp;if (!(%<<span>ct</span>>+1)) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtsiSetSolverStopTime(%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdldefs.html#RTMGetSolverInfo">RTMGetSolverInfo</a>()</span>>, ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((%<<span>cth</span>> + 1) * %<<span>ss</span>> * 4294967296.0));
 <br>&nbsp;&nbsp;&nbsp;&nbsp;} else {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtsiSetSolverStopTime(%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdldefs.html#RTMGetSolverInfo">RTMGetSolverInfo</a>()</span>>, ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((%<<span>ct</span>>  + 1) * %<<span>ss</span>> + %<<span>cth</span>> * %<<span>ss</span>> * 4294967296.0));
 <br>&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;rtsiSetSolverStopTime(%<<span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdldefs.html#RTMGetSolverInfo">RTMGetSolverInfo</a>()</span>>,((%<<span>ct</span>>+1)*%<<span>ss</span>>));
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> retBuf
 <br>&nbsp;&nbsp;<span class="tlc_comment">%%</span>
 <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> retBuf
 <br><span class="tlc_fkw">%endfunction</span> <span class="tlc_comment">%% ERTSetSolverStopTime</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>FcnGenChangeStepSizesFcn<span style="padding-left:9.5px"></span>===========================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Generate<span style="padding-left:9.5px"></span>a<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>that<span style="padding-left:9.5px"></span>changes<span style="padding-left:9.5px"></span>all<span style="padding-left:9.5px"></span>stepsizes<span style="padding-left:9.5px"></span>using<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>new<span style="padding-left:9.5px"></span>baseRateStepSize.
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>The<span style="padding-left:9.5px"></span>generated<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>can<span style="padding-left:9.5px"></span>NOT<span style="padding-left:9.5px"></span>be<span style="padding-left:9.5px"></span>called<span style="padding-left:9.5px"></span>after<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>stepsizes<span style="padding-left:9.5px"></span>have<span style="padding-left:9.5px"></span>been<span style="padding-left:9.5px"></span>initialized.
</span> <br><span class="tlc_fkw">%function</span> <a id="FcnGenChangeStepSizesFcn" class="tlc_func">FcnGenChangeStepSizesFcn</a>()
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> retBuf
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnAbstract = "Change all stepsize using the newBaseRateStepSize"
 <br>&nbsp;&nbsp;<span class="tlc_with">%with</span> ::CompiledModel
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> rootSystem        = System[NumSystems-1]
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> reqInsts = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#LibGetSystemField">LibGetSystemField</a>(rootSystem, "ReqRootPrmHdrDataInsts")
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnName = "%<<span>Name</span>>_ChangeStepSize"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnReturns = "void"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> reqInsts.SimStructInst
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnParams = "real_T newBaseRateStepSize, %<::tSimStructType> *const %<::tSimStruct>"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assign">%assign</span> fcnParams = "real_T newBaseRateStepSize"
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>    
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_createrecord">%createrecord</span> fcnRec {Name fcnName; Returns fcnReturns; Params fcnParams; Abstract fcnAbstract; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category "model"; GeneratedBy "<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html">ertmdlreftiming.tlc</a>"; Type "Utility"; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneratedFor <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonbodlib.html#FcnGeneratedFor">FcnGeneratedFor</a>(rootSystem)}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonhdrlib.html#SLibDumpFunctionBanner">SLibDumpFunctionBanner</a>(fcnRec)>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_undef">%undef</span> fcnRec
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(fcnName, "MemSecFuncInitTerm", "Pre")>/
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span>fcnReturns</span>> %<<span>fcnName</span>>(%<<span>fcnParams</span>>) {
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;real_T ratio = newBaseRateStepSize / %<SampleTime[0].ClockTickStepSize>;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_assert">%assert</span> SampleTime[0].ClockTickStepSize > 0
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* update non-zore stepsize of periodic 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* sample time. Stepsize of asynchronous
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* sample time is not changed in this function */
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_foreach">%foreach</span> tid = NumSynchronousSampleTimes
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> SampleTime[tid].NeedFloatTime == "yes" &amp;&amp; ...
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!PurelyIntegerCode
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>"><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a></a>("StepSize%<<span>tid</span>>")>  = %<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>"><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a></a>("StepSize%<<span>tid</span>>")> * ratio;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endforeach">%endforeach</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_if">%if</span> NumChildSFunctions || GenerateGRTWrapper
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>"><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a></a>("StepSize")>  = %<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a>"><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/rtmdllib_obs.html#RTMGet">RTMGet</a></a>("StepSize")> * ratio;
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%<<a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/commonprmlib.html#SLibGetFcnMemSecPragma">SLibGetFcnMemSecPragma</a>(fcnName, "MemSecFuncInitTerm", "Post")>/
 <br>&nbsp;&nbsp;&nbsp;<span class="tlc_endwith">%endwith</span>
 <br>&nbsp;&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> retBuf
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;<span class="tlc_return">%return</span> retBuf
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>FcnCallChangeStepSizesFcn<span style="padding-left:9.5px"></span>=======================
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>Abstract:<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>Call<span style="padding-left:9.5px"></span>a<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>that<span style="padding-left:9.5px"></span>changes<span style="padding-left:9.5px"></span>all<span style="padding-left:9.5px"></span>stepsizes<span style="padding-left:9.5px"></span>using<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>the<span style="padding-left:9.5px"></span>new<span style="padding-left:9.5px"></span>baseRateStepSize.
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span><span style="padding-left:9.5px"></span>The<span style="padding-left:9.5px"></span>function<span style="padding-left:9.5px"></span>can<span style="padding-left:9.5px"></span>NOT<span style="padding-left:9.5px"></span>be<span style="padding-left:9.5px"></span>called<span style="padding-left:9.5px"></span>after<span style="padding-left:9.5px"></span>
</span> <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>stepsizes<span style="padding-left:9.5px"></span>have<span style="padding-left:9.5px"></span>been<span style="padding-left:9.5px"></span>initialized.
</span> <br><span class="tlc_comment">%%
</span> <br><span class="tlc_fkw">%function</span> <a id="FcnCallChangeStepSizesFcn" class="tlc_func">FcnCallChangeStepSizesFcn</a>(newBaseRateStepSize)
 <br>&nbsp;&nbsp;<span class="tlc_openfile">%openfile</span> retBuf
 <br>&nbsp;&nbsp;/* Change all stepsize using the newBaseRateStepSize */
 <br>&nbsp;&nbsp;<span class="tlc_assert">%assert</span> SampleTime[0].ClockTickStepSize > 0
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> rootSystem        = System[NumSystems-1]
 <br>&nbsp;&nbsp;<span class="tlc_assign">%assign</span> reqInsts = <a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/sysbodlib.html#LibGetSystemField">LibGetSystemField</a>(rootSystem, "ReqRootPrmHdrDataInsts")
 <br>&nbsp; <br>&nbsp;&nbsp;<span class="tlc_if">%if</span> reqInsts.SimStructInst 
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span>Name</span>>_ChangeStepSize(%<<span>newBaseRateStepSize</span>>, %<::tSimStruct>);
 <br>&nbsp;&nbsp;<span class="tlc_else">%else</span>
 <br>&nbsp;&nbsp;&nbsp;&nbsp;%<<span>Name</span>>_ChangeStepSize(%<<span>newBaseRateStepSize</span>>);
 <br>&nbsp;&nbsp;<span class="tlc_endif">%endif</span>
 <br>&nbsp;&nbsp;<span class="tlc_closefile">%closefile</span> retBuf
 <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;<span class="tlc_return">%return</span> retBuf
 <br><span class="tlc_fkw">%endfunction</span>
 <br>&nbsp; <br><span class="tlc_endif">%endif</span> <span class="tlc_comment">%% _ERT_MODELREF_TIMING_</span>
 <br>&nbsp; <br><span class="tlc_comment">%%<span style="padding-left:9.5px"></span>[EOF]<span style="padding-left:9.5px"></span><a href="https://foool.github.io/r2020a/rtw/c/tlc/mw/ertmdlreftiming.html">ertmdlreftiming.tlc</a>
</span> <br></body></html>